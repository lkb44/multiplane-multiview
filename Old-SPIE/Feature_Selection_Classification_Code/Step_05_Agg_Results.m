clear all; close all; clc;

filepaths = ["/Volumes/GoogleDrive/Shared drives/INVent/tom/Conferences/2022_SPIE/Shape_and_texture_Feature_Results/21-Aug-2022_22_30_07_shape_Axial_lumen_only/",...
"/Volumes/GoogleDrive/Shared drives/INVent/tom/Conferences/2022_SPIE/Shape_and_texture_Feature_Results/21-Aug-2022_22_31_07_shape_Axial_tumor_only/",...
"/Volumes/GoogleDrive/Shared drives/INVent/tom/Conferences/2022_SPIE/Shape_and_texture_Feature_Results/21-Aug-2022_22_32_11_shape_Axial_fat_only/",...
"/Volumes/GoogleDrive/Shared drives/INVent/tom/Conferences/2022_SPIE/Shape_and_texture_Feature_Results/21-Aug-2022_22_32_53_shape_Coronal_lumen_only/",...
"/Volumes/GoogleDrive/Shared drives/INVent/tom/Conferences/2022_SPIE/Shape_and_texture_Feature_Results/21-Aug-2022_22_33_23_shape_Coronal_rw_only/",...
"/Volumes/GoogleDrive/Shared drives/INVent/tom/Conferences/2022_SPIE/Shape_and_texture_Feature_Results/21-Aug-2022_22_34_30_shape_Coronal_fat_only/",...
"/Volumes/GoogleDrive/Shared drives/INVent/tom/Conferences/2022_SPIE/Shape_and_texture_Feature_Results/21-Aug-2022_22_40_05_texture_Axial_fat_only/",...
"/Volumes/GoogleDrive/Shared drives/INVent/tom/Conferences/2022_SPIE/Shape_and_texture_Feature_Results/21-Aug-2022_22_41_49_texture_Axial_tumor_only/",...
"/Volumes/GoogleDrive/Shared drives/INVent/tom/Conferences/2022_SPIE/Shape_and_texture_Feature_Results/21-Aug-2022_22_42_46_texture_Coronal_rw_only/",...
"/Volumes/GoogleDrive/Shared drives/INVent/tom/Conferences/2022_SPIE/Shape_and_texture_Feature_Results/21-Aug-2022_22_43_53_texture_Coronal_fat_only/"];

training_file = "CV_Training_Results.xlsx";
testing_file = "Holdout_Testing_Dataset_Results.xlsx";

vartypes = ["string", "string", "string", "string", "string", "string", "string", "string", "string", "string", "string"];
varNames = ["feature", "view", "roi", "training_AUC", "training_ACC", "training_SENS", "training_SPEC",...
            "testing_AUC", "testing_ACC", "testing_SENS", "testing_SPEC"];
results = table('Size',[10 11], 'VariableTypes', vartypes, 'VariableNames',varNames);

for i=1:length(filepaths)
    
    current_path = filepaths(:, i);
    disp(current_path);
    path_split = strsplit(current_path,"_");
    feature = path_split(:, 10);
    view = path_split(:, 11);
    roi = path_split(:, 12);
    
    training_results_path = strcat(current_path, "CV_Training_Results.xlsx");
    training_results = readtable(training_results_path);
    
    top_feat_path = strcat(current_path, "Top_Features_Information.xlsx");
    top_features = readtable(top_feat_path);
    
    testing_results_path = strcat(current_path, "Holdout_Testing_Dataset_Results.xlsx");
    testing_results = readtable(testing_results_path);
    
    results(i,:) = {feature, view, roi,...
                    strcat(num2str(training_results.AUC), " ± ", num2str(training_results.AUC_std)),...
                    strcat(num2str(training_results.Accuracy), " ± ", num2str(training_results.Accuracy_std)),...
                    strcat(num2str(training_results.sens), " ± ", num2str(training_results.sens_std)),...
                    strcat(num2str(training_results.specif), " ± ", num2str(training_results.specif_std)),...
                    strcat(num2str(testing_results.AUC)),...
                    strcat(num2str(testing_results.ACC)),...
                    strcat(num2str(testing_results.SENS)),...
                    strcat(num2str(testing_results.SPEC))
                    };
    
end

writetable(results, "Agg_Results.xlsx");
